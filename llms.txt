# tectonicr

`tectonicr` is a free and open-source **R** package for modeling and
analyzing the direction of the maximum horizontal stress (SHmax) based
on the empirical link between the direction of intraplate stress and the
direction of the relative motion of neighboring plates (Wdowinski, 1998;
Stephan et al., 2023). The following methods are available:

- **Direction of the plate boundary forces**:
  [`PoR_shmax()`](https://tobiste.github.io/tectonicr/reference/PoR_azi.md)
  gives the predicted stress field adjacent to a plate boundary,
  calculated using the relative plate motion of the neighboring plates
  using the function
  [`model_shmax()`](https://tobiste.github.io/tectonicr/reference/model_shmax.md).
  The goodness-of-fit can be statistically tested by
  e.g.[`circular_dispersion()`](https://tobiste.github.io/tectonicr/reference/dispersion.md),[`rayleigh_test()`](https://tobiste.github.io/tectonicr/reference/rayleigh_test.md),
  and
  [`confidence_interval()`](https://tobiste.github.io/tectonicr/reference/confidence.md).
- **Distance to plate boundary**:
  [`distance_from_pb()`](https://tobiste.github.io/tectonicr/reference/distance_from_pb.md)
  gives the distance between the stress data point and the plate
  boundary measured along the stress trajectories.
- **Trajectories of the theoretical stress field**
  [`eulerpole_paths()`](https://tobiste.github.io/tectonicr/reference/stress_paths.md)
  generates an `sf` object containing spatial information that is
  suitable to plot with, for instance, `ggplot()`.
- **Azimuth plotting** using
  [`geom_azimuth()`](https://tobiste.github.io/tectonicr/reference/geom_azimuth.md)
  or
  [`geom_azimuthpoint()`](https://tobiste.github.io/tectonicr/reference/geom_azimuthpoint.md)
  in ggplot.
- **Relative rotations from a given set of plate motion parameters**:
  [`equivalent_rotation()`](https://tobiste.github.io/tectonicr/reference/equivalent_rotation.md)
  transfers a set of plate motion parameters into the relative plate
  motions among the given plates.
- **Average direction and variance of a set of SHmax data** using
  (weighted) statistics and other parameters to statistically estimate
  the distribution parameters of pi-directional data.
- **Spatial interpolation of of SHmax**:
  [`PoR_stress2grid()`](https://tobiste.github.io/tectonicr/reference/PoR_stress2grid.md)
  uses distance, method, and quality-weighted mean direction of stress
  data without being affected by angular distortions.
- **Rose plot**
  [`rose()`](https://tobiste.github.io/tectonicr/reference/rose.md)
  shows the frequencies of the orientations in polar coordinates
- **Stress anomaly map**: spatial distribution of the dispersion of the
  observed stress field from the directions of plate boundary forces
  with
  [`kernel_dispersion()`](https://tobiste.github.io/tectonicr/reference/kernel_dispersion.md)
- **Download and filter world stress map data** using
  [`download_WSM()`](https://tobiste.github.io/tectonicr/reference/import_WSM.md)

> The {tectonicr} package is all about orientation data in 2D. For
> analyzing orientations in 3D (spherical statistics, equal-area
> projections, etc. ), check out the
> [structr](https://github.com/tobiste/structr) package!

## Prerequisites

You must have R installed on your system (see
<https://www.r-project.org/>). To install `tectonicr` from CRAN, type
the following code at the R command line prompt:

    install.packages("tectonicr")

## Installation

The most recent development version of `tectonicr` is available from
Github and can be installed on your system as follows:

    # install.packages("remotes") # install if needed
    remotes::install_github('tobiste/tectonicr')
    library('tectonicr')

Using the stress measurements from the San Andreas Fault - Gulf of
California example, a quick analysis and test against the right-lateral
transform plate boundary can be achieved by:

    # load example data
    data(san_andreas)
    data(nuvel1)
    data(plates)

    stress_analysis(
    san_andreas,
    PoR = equivalent_rotation(nuvel1, "na", "pa"),
    type = "right",
    pb = subset(plates, pair == "na-pa")
    )

The code produces the underlying results for Fig. 7 from Stephan et al.
(2023)

![](reference/figures/Figure_07_san_andreas_data_low.jpg)

## Documentation

The detailed documentation can be found at
<https://tobiste.github.io/tectonicr/articles/A_tectonicr.html>

## GUI

There is a graphical user interface that provides some (limited)
`tectonicr` functionalities. No need to install, just click on the link
and you can run `tectonicr` on your browser:

<https://tobiste.shinyapps.io/tectonicr-app/>

## Author

Tobias Stephan (<tstephan@lakeheadu.ca>)

## Feedback, issues, and contributions

I welcome feedback, suggestions, issues, and contributions! If you have
found a bug, please file it
[here](https://github.com/tobiste/tectonicr/issues) with minimal code to
reproduce the issue.

## How to cite tectonicr

When referencing this package, please cite

Stephan, T., Enkelmann, E., and Kroner, U. (2023). Analyzing the
horizontal orientation of the crustal stress adjacent to plate
boundaries. *Scientific Reports*, *13*(1). DOI:
[10.1038/s41598-023-42433-2](https://doi.org/10.1038/s41598-023-42433-2).

and the package DOI:
[10.32614/CRAN.package.tectonicr](https://doi.org/10.32614/CRAN.package.tectonicr).

## License

GPL-3.0 License

# Package index

## All functions

- [`PoR2Geo_azimuth()`](https://tobiste.github.io/tectonicr/reference/PoR2Geo_azimuth.md)
  : Azimuth Conversion From PoR to Geographical Coordinate Reference
  System
- [`PoR_azimuth()`](https://tobiste.github.io/tectonicr/reference/PoR_azi.md)
  [`PoR_shmax()`](https://tobiste.github.io/tectonicr/reference/PoR_azi.md)
  : Azimuth Conversion from Geographical to PoR Coordinate Reference
  System
- [`PoR_coordinates()`](https://tobiste.github.io/tectonicr/reference/PoR_coordinates.md)
  : Coordinates of the Pole of Rotation Reference System
- [`PoR_crs()`](https://tobiste.github.io/tectonicr/reference/PoR_crs.md)
  : PoR coordinate reference system
- [`PoR_distance()`](https://tobiste.github.io/tectonicr/reference/PoR_distance.md)
  : Distance to Pole of Rotation
- [`PoR_map()`](https://tobiste.github.io/tectonicr/reference/PoR_map.md)
  : Map of data in Pole of Rotation reference frame
- [`PoR_stress2grid()`](https://tobiste.github.io/tectonicr/reference/PoR_stress2grid.md)
  [`PoR_stress2grid_stats()`](https://tobiste.github.io/tectonicr/reference/PoR_stress2grid.md)
  : Spatial Interpolation of SHmax in PoR Coordinate Reference System
- [`abs_vel()`](https://tobiste.github.io/tectonicr/reference/abs_vel.md)
  : Absolute Plate Velocity
- [`rad2deg()`](https://tobiste.github.io/tectonicr/reference/angle-conversion.md)
  [`deg2rad()`](https://tobiste.github.io/tectonicr/reference/angle-conversion.md)
  : Degrees to Radians
- [`angle_vectors()`](https://tobiste.github.io/tectonicr/reference/angle_vectors.md)
  : Angle Between Two Vectors
- [`axes()`](https://tobiste.github.io/tectonicr/reference/axes.md) :
  Plot axes
- [`circular_mean_difference()`](https://tobiste.github.io/tectonicr/reference/circle_mean_diff.md)
  [`circular_mean_difference_alt()`](https://tobiste.github.io/tectonicr/reference/circle_mean_diff.md)
  : Circular Mean Difference
- [`circular_mean()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  [`circular_var()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  [`circular_sd()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  [`circular_median()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  [`circular_quantiles()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  [`circular_IQR()`](https://tobiste.github.io/tectonicr/reference/circle_stats.md)
  : Summary Statistics of Circular Data
- [`circular_dispersion_boot()`](https://tobiste.github.io/tectonicr/reference/circular_dispersion_boot.md)
  : Bootstrapped Estimates for Circular Dispersion
- [`circular_mode()`](https://tobiste.github.io/tectonicr/reference/circular_mode.md)
  : Circular Mode
- [`circular_qqplot()`](https://tobiste.github.io/tectonicr/reference/circular_qqplot.md)
  : Quantile-Quantile Linearised Plot for Circular Distributions
- [`circular_range()`](https://tobiste.github.io/tectonicr/reference/circular_range.md)
  : Circular Range
- [`circular_sd_error()`](https://tobiste.github.io/tectonicr/reference/circular_sd_error.md)
  : Standard Error of Mean Direction of Circular Data
- [`circular_summary()`](https://tobiste.github.io/tectonicr/reference/circular_summary.md)
  : Circular Summary Statistics
- [`compact_grid()`](https://tobiste.github.io/tectonicr/reference/compact-grid.md)
  [`compact_grid2()`](https://tobiste.github.io/tectonicr/reference/compact-grid.md)
  : Compact Smoothed Stress Field
- [`confidence_angle()`](https://tobiste.github.io/tectonicr/reference/confidence.md)
  [`confidence_interval()`](https://tobiste.github.io/tectonicr/reference/confidence.md)
  : Confidence Interval around the Mean Direction of Circular Data after
  Batschelet (1971)
- [`confidence_interval_fisher()`](https://tobiste.github.io/tectonicr/reference/confidence_interval_fisher.md)
  : Confidence Interval around the Mean Direction of Circular Data after
  Fisher (1993)
- [`longitude_modulo()`](https://tobiste.github.io/tectonicr/reference/coordinate_mod.md)
  [`latitude_modulo()`](https://tobiste.github.io/tectonicr/reference/coordinate_mod.md)
  : Coordinate Correction
- [`cartesian_to_geographical()`](https://tobiste.github.io/tectonicr/reference/coordinates.md)
  [`geographical_to_cartesian()`](https://tobiste.github.io/tectonicr/reference/coordinates.md)
  [`geographical_to_spherical()`](https://tobiste.github.io/tectonicr/reference/coordinates.md)
  : Coordinate Transformations
- [`cartesian_to_spherical()`](https://tobiste.github.io/tectonicr/reference/coordinates2.md)
  [`spherical_to_cartesian()`](https://tobiste.github.io/tectonicr/reference/coordinates2.md)
  [`spherical_to_geographical()`](https://tobiste.github.io/tectonicr/reference/coordinates2.md)
  : Coordinate Transformations
- [`cpm_models`](https://tobiste.github.io/tectonicr/reference/cpm_models.md)
  : Global model of current plate motions
- [`data2PoR()`](https://tobiste.github.io/tectonicr/reference/data2PoR.md)
  : Transforms coordinates and azimuths into PoR coordinates system
- [`deviation_norm()`](https://tobiste.github.io/tectonicr/reference/deviation_norm.md)
  : Normalize Angle Between Two Directions
- [`deviation_shmax()`](https://tobiste.github.io/tectonicr/reference/deviation_shmax.md)
  : Deviation of Observed and Predicted Directions of Maximum Horizontal
  Stress
- [`circular_distance()`](https://tobiste.github.io/tectonicr/reference/dispersion.md)
  [`circular_dispersion()`](https://tobiste.github.io/tectonicr/reference/dispersion.md)
  [`circular_sd2()`](https://tobiste.github.io/tectonicr/reference/dispersion.md)
  : Circular Distance and Dispersion
- [`dist_greatcircle()`](https://tobiste.github.io/tectonicr/reference/dist_greatcircle.md)
  : Distance between points
- [`distance_binned_stats()`](https://tobiste.github.io/tectonicr/reference/distance_binned_stats.md)
  **\[experimental\]** : Distance Binned Summary Statistics
- [`distance_from_pb()`](https://tobiste.github.io/tectonicr/reference/distance_from_pb.md)
  : Distance from plate boundary
- [`earth_radius()`](https://tobiste.github.io/tectonicr/reference/earth_radius.md)
  : Earth's radius in km
- [`equivalent_rotation()`](https://tobiste.github.io/tectonicr/reference/equivalent_rotation.md)
  : Equivalent rotation
- [`est.kappa()`](https://tobiste.github.io/tectonicr/reference/est.kappa.md)
  : Concentration parameter of von Mises distribution
- [`euler_pole()`](https://tobiste.github.io/tectonicr/reference/euler_pole.md)
  : Euler pole object
- [`geom_azimuth()`](https://tobiste.github.io/tectonicr/reference/geom_azimuth.md)
  : Azimuth visualization
- [`geom_azimuthpoint()`](https://tobiste.github.io/tectonicr/reference/geom_azimuthpoint.md)
  : Azimuth + point visualization
- [`get_azimuth()`](https://tobiste.github.io/tectonicr/reference/get_azimuth.md)
  : Azimuth Between two Points
- [`download_WSM()`](https://tobiste.github.io/tectonicr/reference/import_WSM.md)
  [`load_WSM()`](https://tobiste.github.io/tectonicr/reference/import_WSM.md)
  [`download_WSM2016()`](https://tobiste.github.io/tectonicr/reference/import_WSM.md)
  [`load_WSM2016()`](https://tobiste.github.io/tectonicr/reference/import_WSM.md)
  : World Stress Map Database (WSM)
- [`is.euler()`](https://tobiste.github.io/tectonicr/reference/is.euler.md)
  : Check if object is euler.pole
- [`kuiper_test()`](https://tobiste.github.io/tectonicr/reference/kuiper_test.md)
  : Kuiper Test of Circular Uniformity
- [`line_azimuth()`](https://tobiste.github.io/tectonicr/reference/line_azimuth.md)
  [`lines_azimuths()`](https://tobiste.github.io/tectonicr/reference/line_azimuth.md)
  : Extract azimuths of line segments
- [`mean_resultant_length()`](https://tobiste.github.io/tectonicr/reference/mean_resultant_length.md)
  : Mean Resultant Length
- [`model_shmax()`](https://tobiste.github.io/tectonicr/reference/model_shmax.md)
  : Theoretical Direction of Maximum Horizontal Stress in the
  geographical reference system.
- [`norm_chisq()`](https://tobiste.github.io/tectonicr/reference/norm_chisq.md)
  : Normalized Chi-Squared Test for Circular Data
- [`nuvel1`](https://tobiste.github.io/tectonicr/reference/nuvel1.md) :
  NUVEL-1 Global model of current plate motions
- [`nuvel1_plates`](https://tobiste.github.io/tectonicr/reference/nuvel1_plates.md)
  : Plate Boundaries on the Earth
- [`ot_eigen2d()`](https://tobiste.github.io/tectonicr/reference/ort-eigen.md)
  [`principal_direction()`](https://tobiste.github.io/tectonicr/reference/ort-eigen.md)
  [`axial_strength()`](https://tobiste.github.io/tectonicr/reference/ort-eigen.md)
  [`axial_dispersion()`](https://tobiste.github.io/tectonicr/reference/ort-eigen.md)
  : Decomposition of Orientation Tensor in 2D
- [`ortensor2d()`](https://tobiste.github.io/tectonicr/reference/ortensor2d.md)
  : Orientation Tensor
- [`parse_wsm_quality()`](https://tobiste.github.io/tectonicr/reference/parse_wsm.md)
  [`quantise_wsm_quality()`](https://tobiste.github.io/tectonicr/reference/parse_wsm.md)
  : Numerical values to World Stress Map Quality Ranking
- [`pb2002`](https://tobiste.github.io/tectonicr/reference/pb2002.md) :
  Global model of current plate motions
- [`plates`](https://tobiste.github.io/tectonicr/reference/plates.md) :
  Plate Boundaries on the Earth
- [`plot_density()`](https://tobiste.github.io/tectonicr/reference/plot_density.md)
  : Circular Density Plot
- [`plot_points()`](https://tobiste.github.io/tectonicr/reference/plot_points.md)
  : Add Points to a Circular Plot
- [`geographical_to_PoR()`](https://tobiste.github.io/tectonicr/reference/por_transformation.md)
  [`PoR_to_geographical()`](https://tobiste.github.io/tectonicr/reference/por_transformation.md)
  : Conversion between spherical PoR to geographical coordinate system
- [`prd_err()`](https://tobiste.github.io/tectonicr/reference/prd_err.md)
  : Error of Model's Prediction
- [`projected_pb_strike()`](https://tobiste.github.io/tectonicr/reference/projected_pb_strike.md)
  : Strike of the plate boundary projected on data point
- [`quick_plot()`](https://tobiste.github.io/tectonicr/reference/quick_plot.md)
  : Plotting Stress Analysis Results
- [`rayleigh_test()`](https://tobiste.github.io/tectonicr/reference/rayleigh_test.md)
  : Rayleigh Test of Circular Uniformity
- [`relative_rotation()`](https://tobiste.github.io/tectonicr/reference/relative_rotation.md)
  : Relative rotation between two rotations
- [`roll_circstats()`](https://tobiste.github.io/tectonicr/reference/roll_circstats.md)
  : Apply Rolling Functions using Circular Statistics
- [`roll_normchisq()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  [`roll_rayleigh()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  [`roll_dispersion()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  [`roll_confidence()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  [`roll_dispersion_CI()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  [`roll_dispersion_sde()`](https://tobiste.github.io/tectonicr/reference/rolling_test.md)
  : Apply Rolling Functions using Circular Statistical Tests for
  Uniformity
- [`rose()`](https://tobiste.github.io/tectonicr/reference/rose.md) :
  Rose Diagram
- [`rose_line()`](https://tobiste.github.io/tectonicr/reference/rose_geom.md)
  [`rose_fan()`](https://tobiste.github.io/tectonicr/reference/rose_geom.md)
  : Direction Lines and Fans in Circular Diagram
- [`rose_stats()`](https://tobiste.github.io/tectonicr/reference/rose_stats.md)
  : Show Average Direction and Spread in Rose Diagram
- [`sample_circular_variance()`](https://tobiste.github.io/tectonicr/reference/sample_dispersion.md)
  [`sample_circular_distance()`](https://tobiste.github.io/tectonicr/reference/sample_dispersion.md)
  [`sample_circular_dispersion()`](https://tobiste.github.io/tectonicr/reference/sample_dispersion.md)
  : Sample circular dispersion
- [`circular_sample_median()`](https://tobiste.github.io/tectonicr/reference/sample_median.md)
  [`circular_sample_median_deviation()`](https://tobiste.github.io/tectonicr/reference/sample_median.md)
  : Sample Circular Median and Deviation
- [`second_central_moment()`](https://tobiste.github.io/tectonicr/reference/second_central_moment.md)
  : Second Central Momentum
- [`shortest_distance_to_line()`](https://tobiste.github.io/tectonicr/reference/shortest_distance_to_line.md)
  : Shortest distance between pairs of geometries
- [`atan2_spec()`](https://tobiste.github.io/tectonicr/reference/spec_atan.md)
  [`atan2d_spec()`](https://tobiste.github.io/tectonicr/reference/spec_atan.md)
  : Quadrant-specific inverse of the tangent
- [`orthodrome()`](https://tobiste.github.io/tectonicr/reference/spherical_angle.md)
  [`haversine()`](https://tobiste.github.io/tectonicr/reference/spherical_angle.md)
  [`vincenty()`](https://tobiste.github.io/tectonicr/reference/spherical_angle.md)
  : Angle along great circle on spherical surface
- [`stress2grid()`](https://tobiste.github.io/tectonicr/reference/stress2grid.md)
  [`stress2grid_stats()`](https://tobiste.github.io/tectonicr/reference/stress2grid.md)
  : Spatial Interpolation of SHmax
- [`stress_analysis()`](https://tobiste.github.io/tectonicr/reference/stress_analysis.md)
  : Quick analysis of a stress data set
- [`stress_colors()`](https://tobiste.github.io/tectonicr/reference/stress_colors.md)
  : Color palette for stress regime
- [`san_andreas`](https://tobiste.github.io/tectonicr/reference/stress_data.md)
  [`tibet`](https://tobiste.github.io/tectonicr/reference/stress_data.md)
  [`iceland`](https://tobiste.github.io/tectonicr/reference/stress_data.md)
  : Example crustal stress dataset
- [`eulerpole_paths()`](https://tobiste.github.io/tectonicr/reference/stress_paths.md)
  [`eulerpole_smallcircles()`](https://tobiste.github.io/tectonicr/reference/stress_paths.md)
  [`eulerpole_greatcircles()`](https://tobiste.github.io/tectonicr/reference/stress_paths.md)
  [`eulerpole_loxodromes()`](https://tobiste.github.io/tectonicr/reference/stress_paths.md)
  : Theoretical Plate Tectonic Stress Paths
- [`superimposed_shmax()`](https://tobiste.github.io/tectonicr/reference/superimposed_shmax.md)
  : SHmax direction resulting from multiple plate boundaries
- [`superimposed_shmax_PB()`](https://tobiste.github.io/tectonicr/reference/superimposed_shmax_PB.md)
  : SHmax direction resulting from multiple plate boundaries considering
  distance to plate boundaries
- [`tectonicr.colors()`](https://tobiste.github.io/tectonicr/reference/tectonicr.colors.md)
  : Colors for input variables
- [`vcross()`](https://tobiste.github.io/tectonicr/reference/vcross.md)
  : Vector cross product
- [`vm_qqplot()`](https://tobiste.github.io/tectonicr/reference/vm_qqplot.md)
  : von Mises Quantile-Quantile Plot
- [`rvm()`](https://tobiste.github.io/tectonicr/reference/vonmises.md)
  [`dvm()`](https://tobiste.github.io/tectonicr/reference/vonmises.md)
  [`pvm()`](https://tobiste.github.io/tectonicr/reference/vonmises.md)
  [`qvm()`](https://tobiste.github.io/tectonicr/reference/vonmises.md) :
  The von Mises Distribution
- [`watson_test()`](https://tobiste.github.io/tectonicr/reference/watson_test.md)
  : Watson's \\U^2\\ Test of Circular Uniformity
- [`weighted_rayleigh()`](https://tobiste.github.io/tectonicr/reference/weighted_rayleigh.md)
  : Weighted Goodness-of-fit Test for Circular Data
- [`weighting()`](https://tobiste.github.io/tectonicr/reference/weighting.md)
  : Weighting Factors

# Articles

### Basics

- [Handling large
  datasets](https://tobiste.github.io/tectonicr/articles/datasets.md):
- [Plotting trajectories of theoretical stress
  directions](https://tobiste.github.io/tectonicr/articles/stress_trajectories.md):

### Statistics

- [Circular
  statistics](https://tobiste.github.io/tectonicr/articles/statistics.md):
- [Spatial
  Analysis](https://tobiste.github.io/tectonicr/articles/spatial.md):
- [Spatial
  interpolation](https://tobiste.github.io/tectonicr/articles/interpolation.md):
