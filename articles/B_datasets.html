<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Handling large datasets • tectonicr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Handling large datasets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tectonicr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A_tectonicr.html">1. Introduction to tectonicr</a></li>
    <li><a class="dropdown-item" href="../articles/B_datasets.html">2. Handling large datasets</a></li>
    <li><a class="dropdown-item" href="../articles/C_stress_trajectories.html">3. Plotting trajectories of theoretic stress directions</a></li>
    <li><a class="dropdown-item" href="../articles/D_statistics.html">4. Circular statistics</a></li>
    <li><a class="dropdown-item" href="../articles/E_interpolation.html">5. Spatial interpolation</a></li>
    <li><a class="dropdown-item" href="../articles/F_spatial.html">6. Spatial Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tobiste/tectonicr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Handling large datasets</h1>
                        <h4 data-toc-skip class="author">Tobias
Stephan</h4>
            
            <h4 data-toc-skip class="date">2024-10-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tobiste/tectonicr/blob/main/vignettes/B_datasets.Rmd" class="external-link"><code>vignettes/B_datasets.Rmd</code></a></small>
      <div class="d-none name"><code>B_datasets.Rmd</code></div>
    </div>

    
    
<p>This vignette teaches you how to handle large stress datasets and how
to retrieve relative plate motions parameters from a set of plate
motions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tobiste.github.io/tectonicr/">tectonicr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># load ggplot library</span></span></code></pre></div>
<div class="section level2">
<h2 id="larger-data-sets">Larger Data Sets<a class="anchor" aria-label="anchor" href="#larger-data-sets"></a>
</h2>
<p><strong>tectonicr</strong> also handles larger data sets. A subset of
the World Stress Map data compilation (Heidbach et al. 2016) is included
as an example data set and can be imported through:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"san_andreas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 9 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -118.84 ymin: 35.97 xmax: -112.58 ymax: 39.08</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt;         id   lat     lon azi unc type depth quality regime</span></span>
<span><span class="co">#&gt; 1 wsm00892 38.14 -118.84  50  25  FMS     7       C      S</span></span>
<span><span class="co">#&gt; 2 wsm00893 35.97 -114.71  54  25  FMS     5       C      S</span></span>
<span><span class="co">#&gt; 3 wsm00894 37.93 -118.17  24  25  FMS     5       C      S</span></span>
<span><span class="co">#&gt; 4 wsm00896 38.63 -118.21  41  25  FMS    17       C      N</span></span>
<span><span class="co">#&gt; 5 wsm00897 39.08 -115.62  30  25  FMS     5       C      N</span></span>
<span><span class="co">#&gt; 6 wsm00903 38.58 -112.58  27  25  FMS     7       C      N</span></span>
<span><span class="co">#&gt;                geometry</span></span>
<span><span class="co">#&gt; 1 POINT (-118.84 38.14)</span></span>
<span><span class="co">#&gt; 2 POINT (-114.71 35.97)</span></span>
<span><span class="co">#&gt; 3 POINT (-118.17 37.93)</span></span>
<span><span class="co">#&gt; 4 POINT (-118.21 38.63)</span></span>
<span><span class="co">#&gt; 5 POINT (-115.62 39.08)</span></span>
<span><span class="co">#&gt; 6 POINT (-112.58 38.58)</span></span></code></pre></div>
<blockquote>
<p>The full or an individually filtered world stress map dataset can be
downloaded by <code><a href="../reference/import_WSM2016.html">download_WSM2016()</a></code></p>
</blockquote>
<p>Modeling the stress directions (wrt. to the geographic North pole)
using the Pole of Oration (PoR) of the motion of North America relative
to the Pacific Plate. We test the dataset against a right-laterally
tangential displacement type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nuvel1"</span><span class="op">)</span></span>
<span><span class="va">por</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">nuvel1</span>, <span class="va">nuvel1</span><span class="op">$</span><span class="va">plate.rot</span> <span class="op">==</span> <span class="st">"na"</span><span class="op">)</span></span>
<span><span class="va">san_andreas.prd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PoR_shmax.html">PoR_shmax</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, type <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p>Combine the model results with the coordinates of the observed
data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_andreas.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">)</span>,</span>
<span>  <span class="va">san_andreas.prd</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stress-map">Stress map<a class="anchor" aria-label="anchor" href="#stress-map"></a>
</h2>
<p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> can be used to visualize the results.
The orientation of the axis can be displayed with the function
<code><a href="https://ggplot2.tidyverse.org/reference/geom_spoke.html" class="external-link">geom_spoke()</a></code>. The position argument
<code>position = "center_spoke"</code> aligns the marker symbol at the
center of the point. The deviation can be color coded.
<code><a href="../reference/deviation_norm.html">deviation_norm()</a></code> yields the normalized value of the
deviation, i.e. absolute values between 0 and
90<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>.</p>
<p>Also included are the plate boundary geometries after Bird
(2003):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"plates"</span><span class="op">)</span> <span class="co"># load plate boundary data set</span></span></code></pre></div>
<p>Alternatively, there is also the NUVEL1 plate boundary model by
DeMets et al.  (1990) stored under
<code>data("nuvel1_plates")</code>.</p>
<p>First we create the predicted trajectories of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
(more details in Article 3.):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajectories</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stress_paths.html">eulerpole_loxodromes</a></span><span class="op">(</span><span class="va">por</span>, <span class="fl">40</span>, cw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Then we initialize the plot <code>map</code>…</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">plates</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"|Deviation| in (\u00B0)"</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">22.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Quality rank"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>…and add the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
trajectories and data points:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">trajectories</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_spoke.html" class="external-link">geom_spoke</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">lon</span>,</span>
<span>      y <span class="op">=</span> <span class="va">lat</span>,</span>
<span>      angle <span class="op">=</span> <span class="fu"><a href="../reference/angle-conversion.html">deg2rad</a></span><span class="op">(</span><span class="fl">90</span> <span class="op">-</span> <span class="va">azi</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="../reference/deviation_norm.html">deviation_norm</a></span><span class="op">(</span><span class="va">dev</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">quality</span></span>
<span>    <span class="op">)</span>,</span>
<span>    radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    position <span class="op">=</span> <span class="st">"center_spoke"</span>,</span>
<span>    na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/plot2-1.png" width="700"><!-- ![](san_andreas_map.png) --></p>
<p>The map shows generally low deviation of the observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
directions from the modeled stress direction using counter-clockwise
45<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>
loxodromes.</p>
<p>The <em>normalized</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
test quantifies the fit between the modeled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
direction the observed stress direction considering the reported
uncertainties of the measurement.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/norm_chisq.html">norm_chisq</a></span><span class="op">(</span></span>
<span>  obs <span class="op">=</span> <span class="va">san_andreas.res</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  prd <span class="op">=</span> <span class="fl">135</span>,</span>
<span>  unc <span class="op">=</span> <span class="va">san_andreas.res</span><span class="op">$</span><span class="va">unc</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0529064</span></span></code></pre></div>
<p>The value is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>≤</mo><annotation encoding="application/x-tex">\leq</annotation></semantics></math>
0.15, indicating a significantly good fit of the model. Thus, the
traction of the transform plate boundary explain the stress direction of
the area.</p>
</div>
<div class="section level2">
<h2 id="variation-of-the-direction-of-the-maximum-horizontal-stress-wrt--to-the-distance-to-the-plate-boundary">Variation of the Direction of the Maximum Horizontal Stress wrt. to
the Distance to the Plate Boundary<a class="anchor" aria-label="anchor" href="#variation-of-the-direction-of-the-maximum-horizontal-stress-wrt--to-the-distance-to-the-plate-boundary"></a>
</h2>
<p>The direction of the maximum horizontal stress correlates with plate
motion direction at the plate boundary zone. Towards the plate interior,
plate boundary forces become weaker and other stress sources will
probably dominate.</p>
<p>To visualize the variation of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
wrt. to the distance to the plate boundary, we need to transfer the
direction of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
from the geographic reference system (i.e. azimuth is the deviation of a
direction from geographic North pole) to the <strong>Pole of Rotation
(PoR)</strong> reference system (i.e. azimuth is the deviation from the
PoR).</p>
<blockquote>
<p>The <em>PoR coordinate reference system</em> is the oblique
transformation of the geographical coordinate system with the PoR
coordinates being the the translation factors.</p>
</blockquote>
<p>The azimuth in the <em>PoR reference system</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mrow><mi>P</mi><mi>o</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{PoR}</annotation></semantics></math>
is the angular difference between the azimuth in geographic reference
system
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mrow><mi>g</mi><mi>e</mi><mi>o</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{geo}</annotation></semantics></math>
and the (initial) bearing of the great circle that passes through the
data point and the PoR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>To calculate the distance to the plate boundary, both the plate
boundary geometries and the data points (in geographical coordinates)
will be transformed in to the <em>PoR</em> reference system. In the
<em>PoR</em> system, the distance is the latitudinal or longitudinal
difference between the data points and the inward/outward or tangential
moving plate boundaries, respectively.</p>
<p>This is done with the function <code><a href="../reference/distance_from_pb.html">distance_from_pb()</a></code>, which
returns the angular distances.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate_boundary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">plates</span>, <span class="va">plates</span><span class="op">$</span><span class="va">pair</span> <span class="op">==</span> <span class="st">"na-pa"</span><span class="op">)</span></span>
<span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">distance</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/distance_from_pb.html">distance_from_pb</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">san_andreas</span>,</span>
<span>    PoR <span class="op">=</span> <span class="va">por</span>,</span>
<span>    pb <span class="op">=</span> <span class="va">plate_boundary</span>,</span>
<span>    tangential <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Finally, we visualize the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mrow><mi>H</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">\sigma_{Hmax}</annotation></semantics></math>
direction wrt. to the distance to the plate boundary:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">azi_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_andreas.res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">azi.PoR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance from plate boundary (\u00B0)"</span>, y <span class="op">=</span> <span class="st">"Azimuth in PoR (\u00B0)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">135</span>, <span class="fl">180</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="va">azi.PoR</span> <span class="op">-</span> <span class="va">unc</span>, ymax <span class="op">=</span> <span class="va">azi.PoR</span> <span class="op">+</span> <span class="va">unc</span>,</span>
<span>      color <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">regime</span>, alpha <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">quality</span></span>
<span>    <span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">360</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>    sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="va">.</span>,</span>
<span>      name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">135</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outward"</span>, <span class="st">"Tan (L)"</span>, <span class="st">"Inward"</span>, <span class="st">"Tan (R)"</span>, <span class="st">"Outward"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Quality rank"</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Tectonic regime"</span>, values <span class="op">=</span> <span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">azi_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot1-1.png" width="700"><!-- ![](azimuth.png) --></p>
<p>Adding a rolling statistics (e.g. weighted mean and 95% confidence
interval) of the transformed azimuth:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">san_andreas.res_roll</span> <span class="op">&lt;-</span> <span class="va">san_andreas.res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">r_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/roll_circstats.html">roll_circstats</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">circular_mean</span>, width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">r_conf95</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rolling_test.html">roll_confidence</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">azi_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span> <span class="op">-</span> <span class="va">r_conf95</span><span class="op">)</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span> <span class="op">+</span> <span class="va">r_conf95</span><span class="op">)</span>,</span>
<span>    lty <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">r_mean</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot1_roll-1.png" width="700"></p>
<p>Close to the dextral plate boundary, the majority of the stress data
have a strike-slip fault regime and are oriented around
135<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>
wrt. to the PoR. Thus, the date are parallel to the predicted stress
sourced by a right-lateral displaced plate boundary. Away from the plate
boundary, the data becomes more noisy.</p>
<blockquote>
<p>This azimuth (PoR) vs. distance plot also allows to identify whether
a less known plate boundary represents a inward, outward, or tangential
displaced boundary.</p>
</blockquote>
<p>The relationship between the azimuth and the distance can be better
visualized by using the deviation (normalized by the data precision)
from the the predicted stress direction, i.e. the <em>normalized</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rolling norm chisq:</span></span>
<span><span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">roll_nchisq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rolling_test.html">roll_normchisq</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">azi.PoR</span>,</span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">prd</span>,</span>
<span>  <span class="va">san_andreas.res_roll</span><span class="op">$</span><span class="va">unc</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">51</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_andreas.res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance</span>, y <span class="op">=</span> <span class="va">nchisq</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distance from plate boundary (\u00B0)"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Norm</span> <span class="op">~</span> <span class="va">chi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">.33</span>, <span class="fl">.7</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">san_andreas</span><span class="op">$</span><span class="va">regime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html" class="external-link">sec_axis</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">.</span>,</span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">.33</span>, <span class="fl">.7</span> <span class="op">+</span> <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Good fit"</span>, <span class="st">"Random"</span>, <span class="st">"Systematic\nmisfit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Tectonic regime"</span>, values <span class="op">=</span> <span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="../reference/stress_colors.html">stress_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">san_andreas.res_roll</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">distance</span>, <span class="va">roll_nchisq</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/san.andreas.distanceplot2-1.png" width="700"><!-- ![](nchisq.png) --></p>
<p>We can see that the data in fact starts to scatter notably beyond a
distance of
3.8<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>
and becomes random at
7<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>
away from the plate boundary. Thus, the North American-Pacific plate
boundary zone at the San Andreas Fault is approx.
4–7<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mo>∘</mo></msup><annotation encoding="application/x-tex">^{\circ}</annotation></semantics></math>
(ca. 380–750 km) wide.</p>
<blockquote>
<p>The <em>normalized</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
vs. distance plot allows to specify the width of the plate boundary
zone.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="r-base-plots-for-quick-analysis">R base plots for quick analysis<a class="anchor" aria-label="anchor" href="#r-base-plots-for-quick-analysis"></a>
</h2>
<p>The data deviation map can also be build using base R’s plotting
engine:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setup the colors for the deviation</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tectonicr.colors.html">tectonicr.colors</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/deviation_norm.html">deviation_norm</a></span><span class="op">(</span><span class="va">san_andreas.res</span><span class="op">$</span><span class="va">dev</span><span class="op">)</span>,</span>
<span>  categorical <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup the legend</span></span>
<span><span class="va">col.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">cols</span>, val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>val2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\("</span>, <span class="st">""</span>, <span class="va">val</span><span class="op">)</span>, val2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\["</span>, <span class="st">""</span>, <span class="va">val2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">val2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"PoR longitude"</span>, ylab <span class="op">=</span> <span class="st">"PoR latitude"</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the axis and colors</span></span>
<span><span class="fu"><a href="../reference/axes.html">axes</a></span><span class="op">(</span></span>
<span>  <span class="va">san_andreas</span><span class="op">$</span><span class="va">lon</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">lat</span>, <span class="va">san_andreas</span><span class="op">$</span><span class="va">azi</span>,</span>
<span>  col <span class="op">=</span> <span class="va">cols</span>, add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the plate boundary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">plates</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the trajectories</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">trajectories</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the legend</span></span>
<span><span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomleft"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"|Deviation| in (\u00B0)"</span>,</span>
<span>  inset <span class="op">=</span> <span class="fl">.05</span>, cex <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>  legend <span class="op">=</span> <span class="va">col.legend</span><span class="op">$</span><span class="va">val</span>, fill <span class="op">=</span> <span class="va">col.legend</span><span class="op">$</span><span class="va">col</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="B_datasets_files/figure-html/plot_base-1.png" width="700"></p>
<p>A quick analysis the results can be obtained
<code><a href="../reference/stress_analysis.html">stress_analysis()</a></code> that returns a list. The transformed
coordinates and azimuths as well as the deviations can be viewed by:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stress_analysis.html">stress_analysis</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, <span class="st">"right"</span>, <span class="va">plate_boundary</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;      azi.PoR prd        dev     nchisq      cdist  lat.PoR   lon.PoR  distance</span></span>
<span><span class="co">#&gt; 1 173.240166 135   38.24017 0.18053214 0.38311043 59.05548 -85.46364 -2.446542</span></span>
<span><span class="co">#&gt; 2   1.058195 135 -133.94180 2.21486507 0.51846479 60.50445 -78.16683 -2.751949</span></span>
<span><span class="co">#&gt; 3 147.609558 135   12.60956 0.01962975 0.04765752 59.38025 -84.55317 -2.705483</span></span>
<span><span class="co">#&gt; 4 163.607388 135   28.60739 0.10103489 0.22925429 59.73632 -85.74431 -3.162091</span></span>
<span><span class="co">#&gt; 5 152.233017 135   17.23302 0.03666381 0.08776909 61.68018 -84.31053 -4.988116</span></span>
<span><span class="co">#&gt; 6 150.611386 135   15.61139 0.03008832 0.07242085 63.39714 -80.60932 -6.358818</span></span></code></pre></div>
<p>Statistical parameters describing the distribution of the transformed
azimuths can be displayed by</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">stats</span></span>
<span><span class="co">#&gt;                      mean</span></span>
<span><span class="co">#&gt; mean         138.90248502</span></span>
<span><span class="co">#&gt; sd            18.57998667</span></span>
<span><span class="co">#&gt; var            0.18967312</span></span>
<span><span class="co">#&gt; median       138.94509179</span></span>
<span><span class="co">#&gt; quasi_median 136.85808363</span></span>
<span><span class="co">#&gt; skewness      -0.33779208</span></span>
<span><span class="co">#&gt; kurtosis       2.78636137</span></span>
<span><span class="co">#&gt; conf95         2.08549562</span></span>
<span><span class="co">#&gt; dispersion     0.09858997</span></span>
<span><span class="co">#&gt; norm_chisq     0.05290640</span></span></code></pre></div>
<p>Statistical test results are shown by</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">test</span></span>
<span><span class="co">#&gt; $C</span></span>
<span><span class="co">#&gt; [1] 0.8028201</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $statistic</span></span>
<span><span class="co">#&gt; [1] 38.09802</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p.value</span></span>
<span><span class="co">#&gt; [1] 4.600542e-314</span></span></code></pre></div>
<p>… and the associated plots can be displayed by setting
<code>plot = TRUE</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/stress_analysis.html">stress_analysis</a></span><span class="op">(</span><span class="va">san_andreas</span>, <span class="va">por</span>, <span class="st">"right"</span>, <span class="va">plate_boundary</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bird, Peter. 2003. “An Updated Digital Model of Plate Boundaries”
<em>Geochemistry, Geophysics, Geosystems</em> 4 (3). doi:
10.1029/2001gc000252.
<!---[10.1029/2001gc000252](https://doi.org/10.1029/2001GC000252).--></p>
<p>DeMets, C., R. G. Gordon, D. F. Argus, and S. Stein. 1990. “Current
Plate Motions” <em>Geophysical Journal International</em> 101 (2):
425–78. doi: <a href="https://doi.org/10.1111/j.1365-246x.1990.tb06579.x" class="external-link">10.1111/j.1365-246x.1990.tb06579.x</a>.</p>
<p>Heidbach, Oliver, Mojtaba Rajabi, Karsten Reiter, Moritz Ziegler, and
WSM Team. 2016. “World Stress Map Database Release 2016. V. 1.1.” GFZ
Data Services. doi: <a href="https://doi.org/10.5880/WSM.2016.001" class="external-link">10.5880/WSM.2016.001</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://tobiasstephan1.wixsite.com/tobi" class="external-link">Tobias Stephan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
